import{e as y,f as I,A as U,g as d,h as $,o as u,i as V,w as l,a as o,u as i,c as b,d as k,l as m,m as z,b as S}from"./index-8b5b05ee.js";import{e as g,w as B,H as D,I as x,J as A,K as E,L as H,M as N,p as O}from"./endpoints-a97983b3.js";import{b as R,c as M}from"./SectionTitleLineWithButton-7f6b899e.js";import{_ as P}from"./darkMode-d4261cad.js";import{_ as s,a as n}from"./FormControl-9d942e3e.js";import{_ as w}from"./BaseButton-34cb38d9.js";import{_ as T}from"./BaseButtons-125c5a61.js";import{a as C}from"./LayoutAuthenticated-69cdb4e0.js";import{_ as F}from"./NotificationBarInCard-cd492f22.js";const J={key:0},K=S("b",{class:"capitalize"},"ERRORE: ",-1),W={key:1},ae={__name:"NewPvView",setup(j){const p=y(),h=I(),e=U({pvLat:"",pvLong:"",pvHeight:"",pvDescription:"",power:"",pvUrl:"",wsId:""}),c=d([]);$(()=>{g.get("https://sunsync-main-service.onrender.com"+B,{headers:{Authorization:`Bearer ${p.getToken.value}`}}).then(_=>{_.data.forEach(t=>{c.value.push({id:t._id,label:t.description})})})});const L=async()=>{await g.post("https://sunsync-main-service.onrender.com"+O,{location:{lat:e.pvLat,long:e.pvLong,alt:e.pvHeight},description:e.pvDescription,url:e.pvUrl,installed_power:e.power,ws_id:e.wsId.id},{headers:{Authorization:`Bearer ${p.getToken.value}`}}).then(()=>{r.value=f[1],v.value=!1,setTimeout(()=>h.push("/dashboard"),500)}).catch(()=>{r.value=f[2]})},r=d(0),f=["none","success","danger"],v=d(!0);return(_,t)=>(u(),V(C,null,{default:l(()=>[o(M,null,{default:l(()=>[o(R,{icon:i(D),title:"Nuovo Impianto",main:""},null,8,["icon"]),o(F,{color:r.value},{default:l(()=>[r.value=="danger"?(u(),b("span",J,[K,k(" L'inserimento non Ã¨ andato a buon fine!")])):m("",!0),r.value=="success"?(u(),b("span",W,"Inserimento avvenuto con successo!")):m("",!0)]),_:1},8,["color"]),v.value?(u(),V(P,{key:0,"is-form":"",onSubmit:z(L,["prevent"])},{footer:l(()=>[o(T,null,{default:l(()=>[o(w,{type:"submit",color:"info",label:"Invia"}),o(w,{type:"reset",color:"info",outline:"",label:"Reset"})]),_:1})]),default:l(()=>[o(s,{label:"Posizione Impianto Fotovoltaico"},{default:l(()=>[o(n,{modelValue:e.pvLat,"onUpdate:modelValue":t[0]||(t[0]=a=>e.pvLat=a),type:"number",icon:i(x),placeholder:"Latitudine"},null,8,["modelValue","icon"]),o(n,{modelValue:e.pvLong,"onUpdate:modelValue":t[1]||(t[1]=a=>e.pvLong=a),type:"number",icon:i(A),placeholder:"Longintudine"},null,8,["modelValue","icon"])]),_:1}),o(s,null,{default:l(()=>[o(n,{modelValue:e.pvHeight,"onUpdate:modelValue":t[2]||(t[2]=a=>e.pvHeight=a),type:"number",icon:i(E),placeholder:"Altitudine"},null,8,["modelValue","icon"])]),_:1}),o(s,{label:"Descrizione Impianto Fotovoltaico"},{default:l(()=>[o(n,{modelValue:e.pvDescription,"onUpdate:modelValue":t[3]||(t[3]=a=>e.pvDescription=a),type:"textarea",placeholder:"Descrizione dell'impianto fotovoltaico"},null,8,["modelValue"])]),_:1}),o(s,{label:"Potenza Installata (kW)"},{default:l(()=>[o(n,{modelValue:e.power,"onUpdate:modelValue":t[4]||(t[4]=a=>e.power=a),type:"number",icon:i(H)},null,8,["modelValue","icon"])]),_:1}),o(s,{label:"Url dati fotovoltaico"},{default:l(()=>[o(n,{modelValue:e.pvUrl,"onUpdate:modelValue":t[5]||(t[5]=a=>e.pvUrl=a),type:"url",icon:i(N)},null,8,["modelValue","icon"])]),_:1}),o(s,{label:"Stazione Meteo"},{default:l(()=>[o(n,{modelValue:e.wsId,"onUpdate:modelValue":t[6]||(t[6]=a=>e.wsId=a),options:c.value},null,8,["modelValue","options"])]),_:1})]),_:1},8,["onSubmit"])):m("",!0)]),_:1})]),_:1}))}};export{ae as default};
